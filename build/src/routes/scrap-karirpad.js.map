{"version":3,"sources":["scrap-karirpad.js"],"names":["router","Express","Router","get","req","res","MongoClient","mongoose","total","params","url","response","err","body","statusCode","$","cheerio","load","each","i","valueResult","slug","attr","title","find","text","date","replace","company_logo_url","company_name","children","eq","address","education","age","salary","gender","j","valueGender","length","tarr","split","file","push","Jobs","job","newJob","JSON","stringify","save","send","karirpadRoute"],"mappings":"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","file":"scrap-karirpad.js","sourcesContent":["\"use strict\";\n\nimport Express from 'express'\nimport request from 'request'\nimport cheerio from 'cheerio'\nimport mongoose from 'mongoose'\nimport Jobs from './jobs.js'\n\nlet router = Express.Router()\n\nrouter.get('/:total', (req, res) => {\n  var MongoClient = mongoose.MongoClient;\n\n  let total = req.params.total\n\n  let url = 'https://www.karirpad.com/Lowongan/load_vacancy/semuanya/null/' + total;\n  let response = res;\n\n  request(url, function (err, res, body) {\n    if (err && res.statusCode !== 200) throw err;\n    let $ = cheerio.load(body)\n\n    $('.result').each((i, valueResult) => {\n          // Get Detail Information\n          let slug = $(valueResult).attr('key') + '-karirpad'\n          let title = $(valueResult).find('.result_title').find('a').text()\n          let date = $(valueResult).find('.result_title').find('span').text().replace('Tanggal pemasangan ','')\n          let company_logo_url = $(valueResult).find('.comp_logo').find('img').attr('src')\n          let company_name = $(valueResult).find('.comp_name').children().eq(0).find('a').text()\n          let address = $(valueResult).find('.comp_name').children().eq(3).text()\n          let education = $(valueResult).find('.comp_name').children().eq(5).text().replace(' Pendidikan : ','')\n          let age = $(valueResult).find('.comp_name').find('.add_s_salary').text()\n          let salary = $(valueResult).find('.vac_salary').find('.bold').text()\n          let gender = []\n\n          $(valueResult).find('.h25').each((j, valueGender) => {\n              if ($(valueGender).children().length === 0) {\n                  var tarr = $(valueGender).attr('src').split('/')\n                  var file = tarr[tarr.length-1]\n                  gender.push(file.split('.')[0].replace('gender-',''))\n              }\n          });\n\n          Jobs.find({ slug: slug }, function(err, job) {\n            if (err) throw err;\n\n            // object of the user\n            if (job.length == 0) {\n              let newJob = Jobs({\n                slug: slug,\n                title: title,\n                date: date,\n                company_logo_url: company_logo_url,\n                company_name: company_name,\n                address: address,\n                education: education,\n                age: age,\n                salary: salary,\n                gender: JSON.stringify(gender),\n              });\n\n              newJob.save(function(err) {\n                if (err) throw err;\n              });\n            }\n          });\n    });\n\n    response.send('done')\n  });\n});\n\nexport { router as karirpadRoute }\n"]}